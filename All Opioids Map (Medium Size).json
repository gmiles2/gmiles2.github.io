{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  
    "background": "#dad9d9",
    "width": 400,
    "height": 200,
    
  
    "title": {
        "text": "Overdoses from all types of Opioids in the United States",
        "fontSize": 12,
        "subtitle":"Which ICD categories are included as 'ALL OPIOIDS'",
        "subtitleFontStyle":"italic",
        "subtitleFontSize":10, "anchor": "middle"},
  
    "params": [    
    {"name":"yearSelector", "value":2010,
       "bind":{
         "input": "range",
         "min": 1999, 
         "max": 2020, 
         "step": 1,
         "name": "Year:"}}
         
         
         
         ],    
  
    "projection": {"type": "albersUsa"},
    "mark": {"type": "geoshape",
    "fiXYZll": "black",
    "stroke": "darkcyan",
    "strokeWidth": 0.5},
    
    "data": {
        "url":"https://raw.githubusercontent.com/gmiles2/gmiles2.github.io/main/All%20Opioids%20-%20US%20Data%20.csv",
        "format": {"type": "csv"}},
    
    "transform": [
      {"calculate": "toNumber(yearSelector)", "as": "yearS"},
      {"filter":"datum.yearS == datum.Year"},
  
     
     {"lookup": "State",
            "from": {
                "data": {
                    "url": "https://raw.githubusercontent.com/gmiles2/gmiles2.github.io/main/Week7_Maps.json",
                    "format":{"property":"features"}},
            "key": "properties.NAME",
                "fields": [       
                    "properties",
                    "type",
                    "geometry"]}}],
      
    "encoding":{
          "color":{
            "field":"Crude Rate",
            "type": "quantitative",
            "legend":{
                "title":null, "orient": "right","direction": "vertical"},
            "scale":{"range":["lightyellow", "orange", "red", "darkred"]}},
  
      "tooltip": [
      {"field": "properties.NAME", "type": "nominal", "title": "State"},
      {"field": "Crude Rate", "type": "nominal", "title": "Overdose Rate"},
      {"field": "Deaths", "type": "nominal", "title": "Overdose Deaths"}
      ]
      }}